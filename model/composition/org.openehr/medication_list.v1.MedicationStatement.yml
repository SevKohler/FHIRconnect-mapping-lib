grammar: FHIRConnect/v1.0.0
type: model
metadata:
  name: COMPOSITION.medication_list.v1.MedicationStatement
  version: 0.0.1-alpha
spec:
  system: FHIR
  version: R4
  openEhrConfig:
    archetype: openEHR-EHR-COMPOSITION.medication_list.v1
    revision: 1.0.6
  fhirConfig:
    structureDefinition: http://hl7.org/fhir/StructureDefinition/MedicationStatement

mappings:
  - name: "statusEmpty"
    with:
      fhir: "$resource.status"
    manual:
      - name: "dataAbsent"
        fhir:
          - path: "extension.url"
            value: "http://hl7.org/fhir/StructureDefinition/data-absent-reason"
          - path: "extension.code"
            value: "unsupported"

  - name: "composer"
    with:
      fhir: "$resource.informationSource"
      openehr: "$composition/composer" # often required therefore simplified mapping engine is to resolve Reference -> Composer

  - name: "healthcareFacility"
    with:
      fhir: "$resource.informationSource"
      openehr: "$composition/context/health_care_facility"

  - name: "dateAsserted"
    with:
      fhir: "$resource.dateAsserted"
      openehr: "$composition/context/start_time"